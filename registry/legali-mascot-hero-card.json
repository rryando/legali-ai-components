{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "legali-mascot-hero-card",
  "type": "registry:ui",
  "files": [
    {
      "path": "components/ui/legali/composite/MascotHeroCard.tsx",
      "content": "import * as React from \"react\"\nimport { cn } from \"@/lib/utils\"\nimport { GlassCard } from \"../atomic/GlassCard\"\nimport { LegaliMascot, MascotMotion, type MascotMotionType } from \"../mascot\"\nimport { TypingText } from \"../atomic/TypingText\"\n\nexport type MascotHeroScriptStep = {\n  motion: MascotMotionType\n  /**\n   * Duration for this step in milliseconds.\n   * Use `null` for infinite duration (no auto-advance).\n   */\n  durationMs: number | null\n  /**\n   * Text snippets that will loop continuously in the marquee.\n   */\n  lines: string[]\n}\n\nexport interface MascotHeroCardProps extends React.HTMLAttributes<HTMLDivElement> {\n  heroTitle?: React.ReactNode\n  active?: boolean\n\n  /** Primary script that runs on mount / when activated. */\n  script: MascotHeroScriptStep[]\n\n  /** Script that runs when `triggerKey` changes (interrupt + restart). */\n  interruptScript?: MascotHeroScriptStep[]\n\n  /** Change this value to immediately restart the script. */\n  triggerKey?: string | number\n\n  inactiveMotion?: MascotMotionType\n\n  mascotWidth?: number | string\n  mascotHeight?: number | string\n  mascotBlink?: boolean\n\n  stream?: {\n    /** Base typing speed (ms per character) when `fitToStepDuration` is false or step is infinite. */\n    charIntervalMs?: number\n    /** Pause between lines (ms). */\n    linePauseMs?: number\n    /** Whether to loop through lines continuously while the step is active. */\n    loop?: boolean\n    /** Whether to show a blinking cursor while typing. */\n    showCursor?: boolean\n    /** When step has a finite duration, scale typing speed to fit within it. */\n    fitToStepDuration?: boolean\n  }\n\n  onStepChange?: (index: number) => void\n  onMotionChange?: (motion: MascotMotionType) => void\n}\n\nconst DEFAULT_SCRIPT: MascotHeroScriptStep[] = [\n  {\n    motion: MascotMotion.WAVING,\n    durationMs: 2000,\n    lines: [\"Hey!\", \"Ready to learn?\", \"Pick a module to continue\"],\n  },\n  {\n    motion: MascotMotion.SPEAKING,\n    durationMs: 5000,\n    lines: [\"Focus on the key terms\", \"Try one lesson at a time\", \"You’ve got this\"],\n  },\n  {\n    motion: MascotMotion.IDLE,\n    durationMs: null,\n    lines: [\"Tap any module\", \"Your progress is saved\", \"Let’s keep going\"],\n  },\n]\n\nconst MascotHeroCard = React.forwardRef<HTMLDivElement, MascotHeroCardProps>(\n  (\n    {\n      className,\n      heroTitle,\n      active = true,\n      script,\n      interruptScript,\n      triggerKey,\n      inactiveMotion = MascotMotion.IDLE,\n      mascotWidth = 240,\n      mascotHeight = 240,\n      mascotBlink = true,\n      stream,\n      onStepChange,\n      onMotionChange,\n      ...props\n    },\n    ref\n  ) => {\n    const scriptTimersRef = React.useRef<number[]>([])\n\n    const clearScriptTimers = React.useCallback(() => {\n      scriptTimersRef.current.forEach((t) => clearTimeout(t))\n      scriptTimersRef.current = []\n    }, [])\n\n    const [stepIndex, setStepIndex] = React.useState(0)\n    const [motion, setMotion] = React.useState<MascotMotionType>(inactiveMotion)\n\n    const setStep = React.useCallback(\n      (nextIndex: number, nextMotion: MascotMotionType) => {\n        setStepIndex(nextIndex)\n        setMotion(nextMotion)\n        onStepChange?.(nextIndex)\n        onMotionChange?.(nextMotion)\n      },\n      [onMotionChange, onStepChange]\n    )\n\n    const startScript = React.useCallback(\n      (steps: MascotHeroScriptStep[]) => {\n        clearScriptTimers()\n\n        if (!steps.length) {\n          setStep(0, inactiveMotion)\n          return\n        }\n\n        setStep(0, steps[0].motion)\n\n        let elapsed = 0\n        for (let i = 0; i < steps.length - 1; i++) {\n          const duration = steps[i].durationMs\n          if (duration == null) break\n          elapsed += duration\n\n          const next = steps[i + 1]\n          const handle = window.setTimeout(() => {\n            setStep(i + 1, next.motion)\n          }, elapsed)\n\n          scriptTimersRef.current.push(handle)\n        }\n      },\n      [clearScriptTimers, inactiveMotion, setStep]\n    )\n\n    const activeScript = React.useMemo(() => {\n      return script?.length ? script : DEFAULT_SCRIPT\n    }, [script])\n\n    const interruptScriptResolved = React.useMemo(() => {\n      return interruptScript?.length ? interruptScript : undefined\n    }, [interruptScript])\n\n    const prevTriggerKeyRef = React.useRef<string | number | undefined>(triggerKey)\n\n    React.useEffect(() => {\n      if (!active) {\n        clearScriptTimers()\n        setMotion(inactiveMotion)\n        return\n      }\n\n      const isInterrupt = prevTriggerKeyRef.current !== triggerKey\n      prevTriggerKeyRef.current = triggerKey\n\n      startScript(isInterrupt && interruptScriptResolved ? interruptScriptResolved : activeScript)\n\n      return () => {\n        clearScriptTimers()\n      }\n    }, [\n      active,\n      triggerKey,\n      activeScript,\n      interruptScriptResolved,\n      inactiveMotion,\n      startScript,\n      clearScriptTimers,\n    ])\n\n    const step = (activeScript[stepIndex] ?? activeScript[0] ?? DEFAULT_SCRIPT[0]) as MascotHeroScriptStep\n\n    const prefersReducedMotion = React.useMemo(() => {\n      if (typeof window === \"undefined\" || typeof window.matchMedia !== \"function\") return false\n      return window.matchMedia(\"(prefers-reduced-motion: reduce)\").matches\n    }, [])\n\n    const streamConfig = React.useMemo(() => {\n      return {\n        charIntervalMs: stream?.charIntervalMs ?? 28,\n        linePauseMs: stream?.linePauseMs ?? 650,\n        loop: stream?.loop ?? true,\n        showCursor: stream?.showCursor ?? true,\n        fitToStepDuration: stream?.fitToStepDuration ?? true,\n      }\n    }, [stream])\n\n    const stepLines = React.useMemo(() => {\n      return (step?.lines ?? []).map((l) => l?.trim()).filter(Boolean) as string[]\n    }, [step?.lines])\n\n    const computeTypingSpeedMs = React.useCallback(() => {\n      const minMs = 50\n      const maxMs = 120\n\n      const clamp = (value: number) => Math.max(minMs, Math.min(maxMs, value))\n\n      if (!streamConfig.fitToStepDuration || step.durationMs == null) {\n        return clamp(streamConfig.charIntervalMs)\n      }\n\n      const totalChars = stepLines.reduce((sum, l) => sum + l.length, 0)\n      if (totalChars <= 0) return clamp(streamConfig.charIntervalMs)\n\n      const pauses = Math.max(0, stepLines.length - 1) * streamConfig.linePauseMs\n      const available = Math.max(0, step.durationMs - pauses)\n      const computed = available / totalChars\n      return clamp(computed)\n    }, [step.durationMs, stepLines, streamConfig.charIntervalMs, streamConfig.fitToStepDuration, streamConfig.linePauseMs])\n\n    return (\n      <GlassCard\n        ref={ref}\n        intensity=\"high\"\n        className={cn(\n          \"rounded-3xl overflow-hidden relative\",\n          // Stronger contrast vs page background\n          \"border-blue-300/60\",\n          \"shadow-xl shadow-blue-900/10\",\n          \"animate-border-glow\",\n          \"bg-blue-500/40\",\n          // Hero glow (keep in-family with existing blue tokens)\n          \"shadow-[0_0_35px_rgba(59,130,246,0.22),inset_0_0_18px_rgba(59,130,246,0.10)]\",\n          className\n        )}\n        {...props}\n      >\n        {/* Glow accents */}\n        <div className=\"absolute -top-16 -left-16 w-64 h-64 bg-sky-200/45 rounded-full blur-3xl pointer-events-none\" />\n        <div className=\"absolute -bottom-20 -right-20 w-72 h-72 bg-blue-200/40 rounded-full blur-3xl pointer-events-none\" />\n\n        <div className=\"relative p-4 md:p-5 flex flex-col md:flex-row items-center gap-4 md:gap-6\">\n           <div className=\"shrink-0 relative\">\n            {/* Smoky/Sky backdrop to make the mascot pop */}\n            <div className=\"absolute inset-0 -z-10 flex items-center justify-center pointer-events-none\">\n              <div className=\"absolute w-64 h-64 rounded-full bg-white/45 blur-3xl animate-pulse\" />\n              <div className=\"absolute w-64 h-64 rounded-full bg-white/60 blur-3xl animate-pulse delay-700\" />\n              <div className=\"absolute w-64 h-64 rounded-full bg-white/50 blur-2xl\" />\n            </div>\n            {/* Smoky/Sky backdrop to make the mascot pop */}\n            <LegaliMascot\n              motion={motion}\n              isBlink={mascotBlink}\n              width={mascotWidth}\n              height={mascotHeight}\n              className=\"mx-auto\"\n            />\n          </div>\n\n          <div className=\"flex-1 w-full\">\n            {heroTitle ? (\n              <div className=\"flex items-center justify-between gap-3\">\n                <h2 className=\"font-bold text-lg md:text-xl text-slate-800 tracking-tight\">\n                  {heroTitle}\n                </h2>\n              </div>\n            ) : null}\n\n            <div\n              key={stepIndex}\n              className={cn(\n                \"mt-3 rounded-2xl border border-white/60 bg-white/70 backdrop-blur-md px-4 py-3\",\n                \"animate-in fade-in slide-in-from-bottom\"\n              )}\n            >\n              <div className=\"text-sm md:text-base text-slate-700 leading-relaxed\">\n                {prefersReducedMotion ? (\n                  <p className=\"font-semibold\">{stepLines[0] ?? \"\"}</p>\n                ) : (\n                  <TypingText\n                    key={`${stepIndex}:${String(triggerKey ?? \"\")}`}\n                    className=\"font-semibold\"\n                    texts={stepLines}\n                    speed={computeTypingSpeedMs()}\n                    delay={0}\n                    showCursor={streamConfig.showCursor}\n                    cursor=\"▍\"\n                    cursorClassName=\"text-slate-500\"\n                    loop={streamConfig.loop}\n                    pauseDuration={streamConfig.linePauseMs}\n                    startOnView={false}\n                    once={false}\n                  />\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      </GlassCard>\n    )\n  }\n)\n\nMascotHeroCard.displayName = \"MascotHeroCard\"\n\nexport { MascotHeroCard }\n",
      "type": "registry:ui"
    }
  ],
  "dependencies": ["clsx", "tailwind-merge"],
  "registryDependencies": [
    "https://raw.githubusercontent.com/rryando/legali-ai-components/main/registry/legali-glass-card.json",
    "https://raw.githubusercontent.com/rryando/legali-ai-components/main/registry/legali-mascot.json",
    "https://raw.githubusercontent.com/rryando/legali-ai-components/main/registry/legali-typing-text.json",
    "https://raw.githubusercontent.com/rryando/legali-ai-components/main/registry/legali-lib-utils.json"
  ]
}
