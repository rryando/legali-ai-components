{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "legali-mascot",
  "type": "registry:ui",
  "files": [
    {
      "path": "components/ui/legali/mascot/LegaliMascot.tsx",
      "content": "/**\n * LegaliMascot Component\n *\n * A React wrapper for the Rive mascot animation with support for\n * View Model data binding and motion state control.\n *\n * @module LegaliMascot\n */\n\nimport { useRive, Layout, Fit, Alignment } from '@rive-app/react-canvas'\nimport { useEffect, useRef } from 'react'\n\n/**\n * Available motion states for the mascot animation.\n * These correspond to the MOTIONS enum in the Rive View Model.\n */\nexport const MascotMotion = {\n  EXIT: 'EXIT',\n  NORMAL: 'NORMAL',\n  LAPTOP: 'LAPTOP',\n  WRITING: 'WRITING',\n  IDLE: 'IDLE',\n  THINKING: 'THINKING',\n  CRYING: 'CRYING',\n  SPEAKING: 'SPEAKING',\n  CONFUSED: 'CONFUSED',\n  WAVING: 'WAVING',\n  SHRUG: 'SHRUG',\n  CELEBRATE: 'CELEBRATE',\n  SCHEDULED: 'SCHEDULED',\n  IDEA: 'IDEA',\n  READING: 'READING',\n  THROPHY: 'THROPHY',\n  THUMBSUP: 'THUMBSUP',\n} as const\n\nexport type MascotMotionType = (typeof MascotMotion)[keyof typeof MascotMotion]\n\n/**\n * Human-readable labels for each motion state.\n */\nexport const MascotMotionLabels: Record<MascotMotionType, string> = {\n  [MascotMotion.EXIT]: 'Exit',\n  [MascotMotion.NORMAL]: 'Normal',\n  [MascotMotion.LAPTOP]: 'Laptop',\n  [MascotMotion.WRITING]: 'Writing',\n  [MascotMotion.IDLE]: 'Idle',\n  [MascotMotion.THINKING]: 'Thinking',\n  [MascotMotion.CRYING]: 'Crying',\n  [MascotMotion.SPEAKING]: 'Speaking',\n  [MascotMotion.CONFUSED]: 'Confused',\n  [MascotMotion.WAVING]: 'Waving',\n  [MascotMotion.SHRUG]: 'Shrug',\n  [MascotMotion.CELEBRATE]: 'Celebrate',\n  [MascotMotion.SCHEDULED]: 'Scheduled',\n  [MascotMotion.IDEA]: 'Idea',\n  [MascotMotion.READING]: 'Reading',\n  [MascotMotion.THROPHY]: 'Throphy',\n  [MascotMotion.THUMBSUP]: 'Thumbsup',\n}\n\nexport interface LegaliMascotProps {\n  /**\n   * The current motion/animation state to display.\n   * @default MascotMotion.IDLE\n   */\n  motion?: MascotMotionType\n\n  /**\n   * Whether the mascot should blink.\n   * @default true\n   */\n  isBlink?: boolean\n\n  /**\n   * Width of the canvas container.\n   * @default 300\n   */\n  width?: number | string\n\n  /**\n   * Height of the canvas container.\n   * @default 300\n   */\n  height?: number | string\n\n  /**\n   * Path to the .riv animation file.\n   * @default '/srchttps://raw.githubusercontent.com/rryando/legali-ai-components/main/public/animations/legali.riv'\n   */\n  src?: string\n\n  /**\n   * Name of the state machine to use.\n   * @default 'SM_MASCOT'\n   */\n  stateMachine?: string\n\n  /**\n   * Additional CSS class names for the container.\n   */\n  className?: string\n\n  /**\n   * Callback fired when the Rive animation is loaded.\n   */\n  onLoad?: () => void\n\n  /**\n   * Callback fired when the motion state changes.\n   */\n  onMotionChange?: (motion: MascotMotionType) => void\n}\n\n/**\n * LegaliMascot Component\n *\n * Displays an animated mascot character using Rive animations.\n * The mascot supports multiple motion states and blinking control\n * through View Model data binding.\n */\nexport function LegaliMascot({\n  motion = MascotMotion.IDLE,\n  isBlink = true,\n  width = 300,\n  height = 300,\n  src = 'https://raw.githubusercontent.com/rryando/legali-ai-components/main/public/animations/legali.riv',\n  stateMachine = 'SM_MASCOT',\n  className = '',\n  onLoad,\n  onMotionChange,\n}: LegaliMascotProps) {\n  // Store references to view model properties\n  const blinkPropertyRef = useRef<any>(null)\n  const animatesPropertyRef = useRef<any>(null)\n  const isInitializedRef = useRef(false)\n\n  const handleRiveLoad = () => {\n    // This function is called when the Rive animation is loaded.\n    // The actual initialization logic is in the useEffect hook.\n    // We can use this for external callbacks if needed.\n  }\n\n  const { rive, RiveComponent } = useRive({\n    src,\n    stateMachines: stateMachine,\n    layout: new Layout({\n      fit: Fit.Contain,\n      alignment: Alignment.Center,\n    }),\n    autoplay: true,\n    autoBind: true, // Enable auto-binding to the default view model instance\n    onLoad: handleRiveLoad,\n  })\n\n  // Initialize view model properties when rive becomes available\n  useEffect(() => {\n    if (rive && !isInitializedRef.current) {\n      try {\n        // Access the auto-bound view model instance\n        const vmi = rive.viewModelInstance\n        console.log('Rive loaded, viewModelInstance:', vmi)\n\n        if (vmi) {\n          // Get boolean property for isBlink\n          blinkPropertyRef.current = vmi.boolean('isBlink')\n          // Get enum property for animates\n          animatesPropertyRef.current = vmi.enum('animates')\n\n          console.log('Properties initialized:', {\n            blink: blinkPropertyRef.current,\n            animates: animatesPropertyRef.current,\n          })\n\n          // Set initial values\n          if (blinkPropertyRef.current) {\n            blinkPropertyRef.current.value = isBlink\n          }\n          if (animatesPropertyRef.current) {\n            animatesPropertyRef.current.value = motion\n          }\n\n          isInitializedRef.current = true\n          onLoad?.()\n        }\n      } catch (error) {\n        console.warn('Failed to initialize view model:', error)\n      }\n    }\n  }, [rive, isBlink, motion, onLoad])\n\n  // Update blink state when prop changes\n  useEffect(() => {\n    if (blinkPropertyRef.current && isInitializedRef.current) {\n      blinkPropertyRef.current.value = isBlink\n    }\n  }, [isBlink])\n\n  // Track previous motion to detect changes\n  const prevMotionRef = useRef<MascotMotionType>(motion)\n\n  // Update motion state when prop changes - reset to NORMAL first\n  useEffect(() => {\n    if (animatesPropertyRef.current && isInitializedRef.current) {\n      // Only apply reset logic if motion actually changed\n      if (prevMotionRef.current !== motion) {\n        // First, set to NORMAL to reset all animation attributes\n        animatesPropertyRef.current.value = MascotMotion.NORMAL\n\n        // After 300ms, apply the target motion\n        const timer = setTimeout(() => {\n          if (animatesPropertyRef.current) {\n            animatesPropertyRef.current.value = motion\n            onMotionChange?.(motion)\n          }\n        }, 300)\n\n        prevMotionRef.current = motion\n\n        return () => clearTimeout(timer)\n      }\n    }\n  }, [motion, onMotionChange])\n\n  return (\n    <div\n      className={`rive-mascot-container ${className}`}\n      style={{\n        width: typeof width === 'number' ? `${width}px` : width,\n        height: typeof height === 'number' ? `${height}px` : height,\n      }}\n    >\n      <RiveComponent />\n    </div>\n  )\n}\n\nexport default LegaliMascot\n",
      "type": "registry:ui"
    },
    {
      "path": "components/ui/legali/mascot/index.ts",
      "content": "/**\n * Mascot Components\n *\n * Export all mascot-related components and types.\n */\n\nexport {\n  LegaliMascot,\n  MascotMotion,\n  MascotMotionLabels,\n  type MascotMotionType,\n  type LegaliMascotProps,\n} from './LegaliMascot'\n",
      "type": "registry:ui"
    },
    {
      "path": "components/ui/legali/mascot/RiveGuide.mdx",
      "content": "import { Meta } from '@storybook/blocks'\n\n<Meta title=\"Legali/Mascot/Usage Guide\" />\n\n# Rive Animation Guide\n\nLearn how to use the **LegaliMascot** component with React and Storybook.\n\n## Quick Start\n\n### 1. Install Dependencies\n\n```bash\nnpm install @rive-app/react-canvas\n# or\npnpm add @rive-app/react-canvas\n# or\nbun add @rive-app/react-canvas\n```\n\n### 2. Add Your Animation File\n\nPlace your `.riv` file in the `public/` directory:\n\n```\npublic/\n  └── mascot.riv\n```\n\n### 3. Import and Use\n\n```tsx\nimport { LegaliMascot, MascotMotion } from '@/components/ui/legali/mascot'\n\nfunction MyComponent() {\n  return (\n    <LegaliMascot\n      motion={MascotMotion.THINKING}\n      isBlink={true}\n      width={300}\n      height={300}\n    />\n  )\n}\n```\n\n---\n\n## API Reference\n\n### LegaliMascot Props\n\n| Prop | Type | Default | Description |\n|------|------|---------|-------------|\n| `motion` | `MascotMotionType` | `MascotMotion.IDLE` | The animation state to display |\n| `isBlink` | `boolean` | `true` | Enable/disable blinking |\n| `width` | `number \\| string` | `300` | Container width |\n| `height` | `number \\| string` | `300` | Container height |\n| `src` | `string` | `'https://raw.githubusercontent.com/rryando/legali-ai-components/main/public/animations/legali.riv'` | Path to .riv file |\n| `stateMachine` | `string` | `'SM_MASCOT'` | State machine name |\n| `className` | `string` | `''` | Additional CSS classes |\n| `onLoad` | `() => void` | - | Callback when loaded |\n| `onMotionChange` | `(motion) => void` | - | Callback on motion change |\n\n---\n\n## Available Motions\n\nThe `MascotMotion` enum provides all available animation states:\n\n```tsx\nimport { MascotMotion } from '@/components/ui/legali/mascot'\n\n// Use in component\n<LegaliMascot motion={MascotMotion.CELEBRATE} />\n```\n\n| Motion | Value | Use Case |\n|--------|-------|----------|\n| `EXIT` | `'EXIT'` | Leaving/closing animation |\n| `NORMAL` | `'NORMAL'` | **Reset state** - resets all attributes |\n| `LAPTOP` | `'LAPTOP'` | Working on computer |\n| `WRITING` | `'WRITING'` | Taking notes |\n| `IDLE` | `'IDLE'` | Idle waiting state |\n| `THINKING` | `'THINKING'` | Processing/pondering |\n| `CRYING` | `'CRYING'` | Error/sad states |\n| `SPEAKING` | `'SPEAKING'` | Talking to user |\n| `CONFUSED` | `'CONFUSED'` | Unclear situations |\n| `WAVING` | `'WAVING'` | Greeting users |\n| `SHRUG` | `'SHRUG'` | Uncertainty |\n| `CELEBRATE` | `'CELEBRATE'` | Success/achievement |\n\n---\n\n## View Model Binding\n\nThe Rive animation uses a **View Model** called `VM_MASCOT` with two bound properties:\n\n```\nVM_MASCOT\n├── isBlink: Boolean    → Controls blinking\n└── animates: MOTIONS   → Controls current motion (Enum)\n```\n\nThe component uses **auto-binding** (`autoBind: true`) to connect to the View Model instance.\n\n---\n\n## Motion Reset Behavior\n\n> **Important:** Before switching to any new motion, the component automatically resets to `NORMAL` state first and waits 300ms before applying the target motion.\n\nThis reset behavior is necessary because:\n- Some animation attributes may be altered on specific keyframes\n- The `NORMAL` state resets all attributes to their default values\n- This ensures clean transitions between different animations\n\n```\nMotion Change Flow:\n1. User sets motion to CELEBRATE\n2. Component sets to NORMAL (reset all attributes)\n3. Wait 300ms\n4. Component sets to CELEBRATE\n5. onMotionChange callback fires\n```\n\nThis is handled automatically by the component - you don't need to manage it manually.\n\n---\n\n## Usage Examples\n\n### Reactive State Changes\n\n```tsx\nimport { useState } from 'react'\nimport { LegaliMascot, MascotMotion } from '@/components/ui/legali/mascot'\n\nfunction InteractiveMascot() {\n  const [motion, setMotion] = useState(MascotMotion.IDLE)\n  const [isLoading, setIsLoading] = useState(false)\n\n  const handleClick = async () => {\n    setMotion(MascotMotion.THINKING)\n    setIsLoading(true)\n\n    await someAsyncOperation()\n\n    setMotion(MascotMotion.CELEBRATE)\n    setIsLoading(false)\n  }\n\n  return (\n    <div>\n      <LegaliMascot motion={motion} />\n      <button onClick={handleClick} disabled={isLoading}>\n        Process\n      </button>\n    </div>\n  )\n}\n```\n\n### Conditional Animations\n\n```tsx\nfunction StatusMascot({ status }: { status: 'success' | 'error' | 'loading' }) {\n  const getMotion = () => {\n    switch (status) {\n      case 'success': return MascotMotion.CELEBRATE\n      case 'error': return MascotMotion.CRYING\n      case 'loading': return MascotMotion.THINKING\n      default: return MascotMotion.IDLE\n    }\n  }\n\n  return <LegaliMascot motion={getMotion()} />\n}\n```\n\n### Custom Styling\n\n```tsx\n<LegaliMascot\n  motion={MascotMotion.WAVING}\n  className=\"rounded-full shadow-lg\"\n  width={200}\n  height={200}\n/>\n```\n\n---\n\n## Best Practices\n\n1. **Preload Animations** - Load the .riv file early to avoid delays\n2. **Use Semantic Motions** - Match animations to UX context (e.g., CELEBRATE for success)\n3. **Handle Loading** - Use `onLoad` callback to show loading states\n4. **Optimize Size** - Use appropriate dimensions for your layout\n5. **Accessibility** - Consider reducing motion for users who prefer it\n\n---\n\n## Troubleshooting\n\n### Animation Not Loading\n\n- Verify the `.riv` file exists at the specified `src` path\n- Check browser console for CORS or 404 errors\n- Ensure the state machine name matches exactly\n\n### Motions Not Changing\n\n- Confirm the state machine input names match (`isBlink`, `animates`)\n- Check that the View Model is properly configured in Rive\n\n### Performance Issues\n\n- Use smaller canvas dimensions when possible\n- Consider lazy loading for off-screen mascots\n- Limit simultaneous Rive instances on a page\n",
      "type": "registry:ui"
    }
  ],
  "dependencies": ["@rive-app/react-canvas"]
}
