{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "legali-mascot",
  "type": "registry:ui",
  "files": [
    {
      "path": "components/ui/legali/mascot/LegaliMascot.tsx",
      "content": "/**\n * @see {@link https://raw.githubusercontent.com/rryando/legali-ai-components/main/registry/legali-mascot.json} — Install:\n * @example npx shadcn@latest add \"https://raw.githubusercontent.com/rryando/legali-ai-components/main/registry/legali-mascot.json\"\n */\n/**\n * LegaliMascot Component\n *\n * A React wrapper for the Rive mascot animation with support for\n * View Model data binding and motion state control.\n *\n * @module LegaliMascot\n */\n\nimport { Alignment, Fit, Layout, useRive } from \"@rive-app/react-canvas\";\nimport { AnimatePresence, motion } from \"motion/react\";\nimport { useEffect, useRef } from \"react\";\nimport { cn } from \"@/lib/utils\";\nimport { TypingText } from \"@/components/ui/legali/atomic/TypingText\";\n\n/**\n * Available motion states for the mascot animation.\n * These correspond to the MOTIONS enum in the Rive View Model.\n */\nexport const MascotMotion = {\n  EXIT: \"EXIT\",\n  NORMAL: \"NORMAL\",\n  LAPTOP: \"LAPTOP\",\n  WRITING: \"WRITING\",\n  IDLE: \"IDLE\",\n  THINKING: \"THINKING\",\n  CRYING: \"CRYING\",\n  SPEAKING: \"SPEAKING\",\n  CONFUSED: \"CONFUSED\",\n  WAVING: \"WAVING\",\n  SHRUG: \"SHRUG\",\n  CELEBRATE: \"CELEBRATE\",\n  SCHEDULED: \"SCHEDULED\",\n  IDEA: \"IDEA\",\n  READING: \"READING\",\n  THROPHY: \"THROPHY\",\n  THUMBSUP: \"THUMBSUP\",\n} as const;\n\nexport type MascotMotionType = (typeof MascotMotion)[keyof typeof MascotMotion];\n\n/**\n * Human-readable labels for each motion state.\n */\nexport const MascotMotionLabels: Record<MascotMotionType, string> = {\n  [MascotMotion.EXIT]: \"Exit\",\n  [MascotMotion.NORMAL]: \"Normal\",\n  [MascotMotion.LAPTOP]: \"Laptop\",\n  [MascotMotion.WRITING]: \"Writing\",\n  [MascotMotion.IDLE]: \"Idle\",\n  [MascotMotion.THINKING]: \"Thinking\",\n  [MascotMotion.CRYING]: \"Crying\",\n  [MascotMotion.SPEAKING]: \"Speaking\",\n  [MascotMotion.CONFUSED]: \"Confused\",\n  [MascotMotion.WAVING]: \"Waving\",\n  [MascotMotion.SHRUG]: \"Shrug\",\n  [MascotMotion.CELEBRATE]: \"Celebrate\",\n  [MascotMotion.SCHEDULED]: \"Scheduled\",\n  [MascotMotion.IDEA]: \"Idea\",\n  [MascotMotion.READING]: \"Reading\",\n  [MascotMotion.THROPHY]: \"Throphy\",\n  [MascotMotion.THUMBSUP]: \"Thumbsup\",\n};\n\n/**\n * Position of the speech bubble relative to the mascot.\n */\nexport type SpeechBubblePosition = \"top\" | \"top-left\" | \"top-right\" | \"left\" | \"right\";\n\nexport type LegaliMascotProps = {\n  /**\n   * The current motion/animation state to display.\n   * When speechText is provided, this will be overridden to SPEAKING.\n   * @default MascotMotion.IDLE\n   */\n  motion?: MascotMotionType;\n\n  /**\n   * Whether the mascot should blink.\n   * @default true\n   */\n  isBlink?: boolean;\n\n  /**\n   * Width of the canvas container.\n   * @default 300\n   */\n  width?: number | string;\n\n  /**\n   * Height of the canvas container.\n   * @default 300\n   */\n  height?: number | string;\n\n  /**\n   * Path to the .riv animation file.\n   * @default '/srchttps://raw.githubusercontent.com/rryando/legali-ai-components/main/public/animations/legali.riv'\n   */\n  src?: string;\n\n  /**\n   * Name of the state machine to use.\n   * @default 'SM_MASCOT'\n   */\n  stateMachine?: string;\n\n  /**\n   * Additional CSS class names for the container.\n   */\n  className?: string;\n\n  /**\n   * Callback fired when the Rive animation is loaded.\n   */\n  onLoad?: () => void;\n\n  /**\n   * Callback fired when the motion state changes.\n   */\n  onMotionChange?: (motion: MascotMotionType) => void;\n\n  // ─────────────────────────────────────────────────────────────────────────\n  // Speech Bubble Props\n  // ─────────────────────────────────────────────────────────────────────────\n\n  /**\n   * Text to display in the speech bubble. When provided, the mascot will\n   * automatically switch to SPEAKING motion and show the speech bubble.\n   */\n  speechText?: string;\n\n  /**\n   * Array of texts to cycle through in the speech bubble.\n   * Takes precedence over speechText if provided.\n   */\n  speechTexts?: string[];\n\n  /**\n   * Typing speed for the speech bubble text in milliseconds.\n   * @default 40\n   */\n  speechSpeed?: number;\n\n  /**\n   * Whether to loop through speechTexts.\n   * @default false\n   */\n  speechLoop?: boolean;\n\n  /**\n   * Pause duration between text cycles in milliseconds.\n   * @default 2000\n   */\n  speechPauseDuration?: number;\n\n  /**\n   * Position of the speech bubble relative to the mascot.\n   * @default \"top-right\"\n   */\n  speechBubblePosition?: SpeechBubblePosition;\n\n  /**\n   * Additional CSS class names for the speech bubble.\n   */\n  speechBubbleClassName?: string;\n\n  /**\n   * Whether to show the cursor in the typing animation.\n   * @default true\n   */\n  showCursor?: boolean;\n\n  /**\n   * Callback fired when the speech typing completes.\n   */\n  onSpeechComplete?: () => void;\n\n  /**\n   * Maximum width of the speech bubble.\n   * @default 200\n   */\n  speechBubbleMaxWidth?: number;\n};\n\n/**\n * Get position classes for speech bubble placement.\n */\nfunction getSpeechBubblePositionClasses(position: SpeechBubblePosition): string {\n  const positionClasses: Record<SpeechBubblePosition, string> = {\n    top: \"bottom-full left-1/2 -translate-x-1/2 mb-2\",\n    \"top-left\": \"bottom-full right-1/4 mb-2\",\n    \"top-right\": \"bottom-full left-1/4 mb-2\",\n    left: \"right-full top-1/2 -translate-y-1/2 mr-2\",\n    right: \"left-full top-1/2 -translate-y-1/2 ml-2\",\n  };\n  return positionClasses[position];\n}\n\n/**\n * Get tail position classes for speech bubble tail.\n */\nfunction getSpeechBubbleTailClasses(position: SpeechBubblePosition): string {\n  const tailClasses: Record<SpeechBubblePosition, string> = {\n    top: \"top-full left-1/2 -translate-x-1/2 border-l-transparent border-r-transparent border-b-transparent border-t-white\",\n    \"top-left\":\n      \"top-full right-6 border-l-transparent border-r-transparent border-b-transparent border-t-white\",\n    \"top-right\":\n      \"top-full left-6 border-l-transparent border-r-transparent border-b-transparent border-t-white\",\n    left: \"left-full top-1/2 -translate-y-1/2 border-t-transparent border-b-transparent border-r-transparent border-l-white\",\n    right:\n      \"right-full top-1/2 -translate-y-1/2 border-t-transparent border-b-transparent border-l-transparent border-r-white\",\n  };\n  return tailClasses[position];\n}\n\n// Rive view model property type\ntype RiveViewModelProperty = { value: unknown };\n\n/**\n * LegaliMascot Component\n *\n * Displays an animated mascot character using Rive animations.\n * The mascot supports multiple motion states and blinking control\n * through View Model data binding. Optionally displays a speech bubble\n * with animated typing text.\n */\nexport function LegaliMascot({\n  motion: motionProp = MascotMotion.IDLE,\n  isBlink = true,\n  width = 300,\n  height = 300,\n  src = \"https://raw.githubusercontent.com/rryando/legali-ai-components/main/public/animations/legali.riv\",\n  stateMachine = \"SM_MASCOT\",\n  className = \"\",\n  onLoad,\n  onMotionChange,\n  // Speech bubble props\n  speechText,\n  speechTexts,\n  speechSpeed = 40,\n  speechLoop = false,\n  speechPauseDuration = 2000,\n  speechBubblePosition = \"top-right\",\n  speechBubbleClassName,\n  showCursor = true,\n  onSpeechComplete,\n  speechBubbleMaxWidth = 200,\n}: LegaliMascotProps) {\n  // Determine if we should show the speech bubble\n  const hasSpeech = Boolean(speechText || (speechTexts && speechTexts.length > 0));\n\n  // When speaking, override the motion to SPEAKING\n  const effectiveMotion = hasSpeech ? MascotMotion.SPEAKING : motionProp;\n\n  // Store references to view model properties\n  const blinkPropertyRef = useRef<RiveViewModelProperty | null>(null);\n  const animatesPropertyRef = useRef<RiveViewModelProperty | null>(null);\n  const isInitializedRef = useRef(false);\n\n  const handleRiveLoad = () => {\n    // This function is called when the Rive animation is loaded.\n    // The actual initialization logic is in the useEffect hook.\n  };\n\n  const { rive, RiveComponent } = useRive({\n    src,\n    stateMachines: stateMachine,\n    layout: new Layout({\n      fit: Fit.Contain,\n      alignment: Alignment.Center,\n    }),\n    autoplay: true,\n    autoBind: true,\n    onLoad: handleRiveLoad,\n  });\n\n  // Initialize view model properties when rive becomes available\n  useEffect(() => {\n    if (!rive || isInitializedRef.current) {\n      return;\n    }\n\n    try {\n      const vmi = rive.viewModelInstance;\n      if (!vmi) {\n        return;\n      }\n\n      blinkPropertyRef.current = vmi.boolean(\"isBlink\");\n      animatesPropertyRef.current = vmi.enum(\"animates\");\n\n      if (blinkPropertyRef.current) {\n        blinkPropertyRef.current.value = isBlink;\n      }\n      if (animatesPropertyRef.current) {\n        animatesPropertyRef.current.value = effectiveMotion;\n      }\n\n      isInitializedRef.current = true;\n      onLoad?.();\n    } catch (error) {\n      console.warn(\"Failed to initialize view model:\", error);\n    }\n  }, [rive, isBlink, effectiveMotion, onLoad]);\n\n  // Update blink state when prop changes\n  useEffect(() => {\n    if (blinkPropertyRef.current && isInitializedRef.current) {\n      blinkPropertyRef.current.value = isBlink;\n    }\n  }, [isBlink]);\n\n  // Track previous motion to detect changes\n  const prevMotionRef = useRef<MascotMotionType>(effectiveMotion);\n\n  // Update motion state when prop changes - reset to NORMAL first\n  useEffect(() => {\n    if (!(animatesPropertyRef.current && isInitializedRef.current)) {\n      return;\n    }\n    if (prevMotionRef.current === effectiveMotion) {\n      return;\n    }\n\n    // First, set to NORMAL to reset all animation attributes\n    animatesPropertyRef.current.value = MascotMotion.NORMAL;\n\n    // After 300ms, apply the target motion\n    const timer = setTimeout(() => {\n      if (animatesPropertyRef.current) {\n        animatesPropertyRef.current.value = effectiveMotion;\n        onMotionChange?.(effectiveMotion);\n      }\n    }, 300);\n\n    prevMotionRef.current = effectiveMotion;\n\n    return () => clearTimeout(timer);\n  }, [effectiveMotion, onMotionChange]);\n\n  return (\n    <div\n      className={cn(\"rive-mascot-container relative\", className)}\n      style={{\n        width: typeof width === \"number\" ? `${width}px` : width,\n        height: typeof height === \"number\" ? `${height}px` : height,\n      }}\n    >\n      <RiveComponent />\n\n      {/* Speech Bubble */}\n      <AnimatePresence>\n        {hasSpeech ? (\n          <motion.div\n            animate={{ opacity: 1, scale: 1, y: 0 }}\n            className={cn(\"absolute z-10\", getSpeechBubblePositionClasses(speechBubblePosition))}\n            exit={{ opacity: 0, scale: 0.9, y: 10 }}\n            initial={{ opacity: 0, scale: 0.9, y: 10 }}\n            transition={{ duration: 0.2, ease: \"easeOut\" }}\n          >\n            <div\n              className={cn(\n                \"relative rounded-2xl border border-slate-200/60 bg-white px-4 py-3 shadow-lg\",\n                \"text-slate-700 text-sm leading-relaxed\",\n                speechBubbleClassName\n              )}\n              style={{ maxWidth: speechBubbleMaxWidth }}\n            >\n              <TypingText\n                cursor=\"▍\"\n                cursorClassName=\"text-slate-400\"\n                delay={100}\n                loop={speechLoop}\n                onComplete={onSpeechComplete}\n                pauseDuration={speechPauseDuration}\n                showCursor={showCursor}\n                speed={speechSpeed}\n                startOnView={false}\n                text={speechTexts && speechTexts.length > 0 ? undefined : speechText}\n                texts={speechTexts && speechTexts.length > 0 ? speechTexts : undefined}\n              />\n\n              {/* Speech Bubble Tail */}\n              <div\n                className={cn(\n                  \"absolute h-0 w-0 border-8 border-solid\",\n                  getSpeechBubbleTailClasses(speechBubblePosition)\n                )}\n              />\n            </div>\n          </motion.div>\n        ) : null}\n      </AnimatePresence>\n    </div>\n  );\n}\n\nexport default LegaliMascot;\n",
      "type": "registry:ui"
    },
    {
      "path": "components/ui/legali/mascot/index.ts",
      "content": "/**\n * @see {@link https://raw.githubusercontent.com/rryando/legali-ai-components/main/registry/legali-mascot.json} — Install:\n * @example npx shadcn@latest add \"https://raw.githubusercontent.com/rryando/legali-ai-components/main/registry/legali-mascot.json\"\n */\n/**\n * Mascot Components\n *\n * Export all mascot-related components and types.\n */\n\nexport {\n  LegaliMascot,\n  type LegaliMascotProps,\n  MascotMotion,\n  MascotMotionLabels,\n  type MascotMotionType,\n  type SpeechBubblePosition,\n} from \"./LegaliMascot\";\n",
      "type": "registry:ui"
    },
    {
      "path": "components/ui/legali/mascot/RiveGuide.mdx",
      "content": "import { Meta } from '@storybook/blocks'\n\n<Meta title=\"Legali/Mascot/Usage Guide\" />\n\n# Rive Animation Guide\n\nLearn how to use the **LegaliMascot** component with React and Storybook.\n\n## Quick Start\n\n### 1. Install Dependencies\n\n```bash\nnpm install @rive-app/react-canvas\n# or\npnpm add @rive-app/react-canvas\n# or\nbun add @rive-app/react-canvas\n```\n\n### 2. Add Your Animation File\n\nPlace your `.riv` file in the `public/` directory:\n\n```\npublic/\n  └── mascot.riv\n```\n\n### 3. Import and Use\n\n```tsx\nimport { LegaliMascot, MascotMotion } from '@/components/ui/legali/mascot'\n\nfunction MyComponent() {\n  return (\n    <LegaliMascot\n      motion={MascotMotion.THINKING}\n      isBlink={true}\n      width={300}\n      height={300}\n    />\n  )\n}\n```\n\n---\n\n## API Reference\n\n### LegaliMascot Props\n\n| Prop | Type | Default | Description |\n|------|------|---------|-------------|\n| `motion` | `MascotMotionType` | `MascotMotion.IDLE` | The animation state to display |\n| `isBlink` | `boolean` | `true` | Enable/disable blinking |\n| `width` | `number \\| string` | `300` | Container width |\n| `height` | `number \\| string` | `300` | Container height |\n| `src` | `string` | `'https://raw.githubusercontent.com/rryando/legali-ai-components/main/public/animations/legali.riv'` | Path to .riv file |\n| `stateMachine` | `string` | `'SM_MASCOT'` | State machine name |\n| `className` | `string` | `''` | Additional CSS classes |\n| `onLoad` | `() => void` | - | Callback when loaded |\n| `onMotionChange` | `(motion) => void` | - | Callback on motion change |\n\n---\n\n## Available Motions\n\nThe `MascotMotion` enum provides all available animation states:\n\n```tsx\nimport { MascotMotion } from '@/components/ui/legali/mascot'\n\n// Use in component\n<LegaliMascot motion={MascotMotion.CELEBRATE} />\n```\n\n| Motion | Value | Use Case |\n|--------|-------|----------|\n| `EXIT` | `'EXIT'` | Leaving/closing animation |\n| `NORMAL` | `'NORMAL'` | **Reset state** - resets all attributes |\n| `LAPTOP` | `'LAPTOP'` | Working on computer |\n| `WRITING` | `'WRITING'` | Taking notes |\n| `IDLE` | `'IDLE'` | Idle waiting state |\n| `THINKING` | `'THINKING'` | Processing/pondering |\n| `CRYING` | `'CRYING'` | Error/sad states |\n| `SPEAKING` | `'SPEAKING'` | Talking to user |\n| `CONFUSED` | `'CONFUSED'` | Unclear situations |\n| `WAVING` | `'WAVING'` | Greeting users |\n| `SHRUG` | `'SHRUG'` | Uncertainty |\n| `CELEBRATE` | `'CELEBRATE'` | Success/achievement |\n\n---\n\n## View Model Binding\n\nThe Rive animation uses a **View Model** called `VM_MASCOT` with two bound properties:\n\n```\nVM_MASCOT\n├── isBlink: Boolean    → Controls blinking\n└── animates: MOTIONS   → Controls current motion (Enum)\n```\n\nThe component uses **auto-binding** (`autoBind: true`) to connect to the View Model instance.\n\n---\n\n## Motion Reset Behavior\n\n> **Important:** Before switching to any new motion, the component automatically resets to `NORMAL` state first and waits 300ms before applying the target motion.\n\nThis reset behavior is necessary because:\n- Some animation attributes may be altered on specific keyframes\n- The `NORMAL` state resets all attributes to their default values\n- This ensures clean transitions between different animations\n\n```\nMotion Change Flow:\n1. User sets motion to CELEBRATE\n2. Component sets to NORMAL (reset all attributes)\n3. Wait 300ms\n4. Component sets to CELEBRATE\n5. onMotionChange callback fires\n```\n\nThis is handled automatically by the component - you don't need to manage it manually.\n\n---\n\n## Usage Examples\n\n### Reactive State Changes\n\n```tsx\nimport { useState } from 'react'\nimport { LegaliMascot, MascotMotion } from '@/components/ui/legali/mascot'\n\nfunction InteractiveMascot() {\n  const [motion, setMotion] = useState(MascotMotion.IDLE)\n  const [isLoading, setIsLoading] = useState(false)\n\n  const handleClick = async () => {\n    setMotion(MascotMotion.THINKING)\n    setIsLoading(true)\n\n    await someAsyncOperation()\n\n    setMotion(MascotMotion.CELEBRATE)\n    setIsLoading(false)\n  }\n\n  return (\n    <div>\n      <LegaliMascot motion={motion} />\n      <button onClick={handleClick} disabled={isLoading}>\n        Process\n      </button>\n    </div>\n  )\n}\n```\n\n### Conditional Animations\n\n```tsx\nfunction StatusMascot({ status }: { status: 'success' | 'error' | 'loading' }) {\n  const getMotion = () => {\n    switch (status) {\n      case 'success': return MascotMotion.CELEBRATE\n      case 'error': return MascotMotion.CRYING\n      case 'loading': return MascotMotion.THINKING\n      default: return MascotMotion.IDLE\n    }\n  }\n\n  return <LegaliMascot motion={getMotion()} />\n}\n```\n\n### Custom Styling\n\n```tsx\n<LegaliMascot\n  motion={MascotMotion.WAVING}\n  className=\"rounded-full shadow-lg\"\n  width={200}\n  height={200}\n/>\n```\n\n---\n\n## Best Practices\n\n1. **Preload Animations** - Load the .riv file early to avoid delays\n2. **Use Semantic Motions** - Match animations to UX context (e.g., CELEBRATE for success)\n3. **Handle Loading** - Use `onLoad` callback to show loading states\n4. **Optimize Size** - Use appropriate dimensions for your layout\n5. **Accessibility** - Consider reducing motion for users who prefer it\n\n---\n\n## Troubleshooting\n\n### Animation Not Loading\n\n- Verify the `.riv` file exists at the specified `src` path\n- Check browser console for CORS or 404 errors\n- Ensure the state machine name matches exactly\n\n### Motions Not Changing\n\n- Confirm the state machine input names match (`isBlink`, `animates`)\n- Check that the View Model is properly configured in Rive\n\n### Performance Issues\n\n- Use smaller canvas dimensions when possible\n- Consider lazy loading for off-screen mascots\n- Limit simultaneous Rive instances on a page\n",
      "type": "registry:ui"
    }
  ],
  "dependencies": [
    "@rive-app/react-canvas"
  ]
}