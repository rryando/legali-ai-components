{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "legali-lawyer-assessment-screen",
  "type": "registry:ui",
  "files": [
    {
      "path": "components/ui/legali/screens/LawyerAssessmentScreen.tsx",
      "content": "/**\n * @see {@link https://raw.githubusercontent.com/rryando/legali-ai-components/main/registry/legali-lawyer-assessment-screen.json} â€” Install:\n * @example npx shadcn@latest add \"https://raw.githubusercontent.com/rryando/legali-ai-components/main/registry/legali-lawyer-assessment-screen.json\"\n */\nimport { ChevronRight, FileEdit } from \"lucide-react\";\nimport { forwardRef, useCallback, useRef, useState } from \"react\";\nimport { cn } from \"@/lib/utils\";\nimport { Button } from \"@/components/ui/legali/button\";\nimport { StepIndicator } from \"../atomic/StepIndicator\";\nimport { AssessmentWritingForm, type AssessmentField } from \"../composite/AssessmentWritingForm\";\nimport type { AssessmentWritingScriptStep, CaseAssessment } from \"../data/marketplace-types\";\nimport { LegaliMascot, MascotMotion, type MascotMotionType } from \"../mascot\";\n\nexport type LawyerAssessmentScreenProps = {\n  script: AssessmentWritingScriptStep[];\n  onAssessmentComplete?: (assessment: CaseAssessment) => void;\n  className?: string;\n};\n\nconst STEPS = [\n  { label: \"Dashboard\" },\n  { label: \"Review\" },\n  { label: \"Consultation\" },\n  { label: \"Assessment\" },\n  { label: \"Payout\" },\n];\n\nfunction buildAssessment(fields: AssessmentField[]): CaseAssessment {\n  const fieldMap = new Map(fields.map((f) => [f.key, f.value]));\n  return {\n    summary: fieldMap.get(\"summary\") ?? \"\",\n    strengths: (fieldMap.get(\"strengths\") ?? \"\").split(\"\\n\").filter(Boolean),\n    concerns: (fieldMap.get(\"concerns\") ?? \"\").split(\"\\n\").filter(Boolean),\n    recommendedSteps: (fieldMap.get(\"recommendedSteps\") ?? \"\").split(\"\\n\").filter(Boolean),\n    timeline: fieldMap.get(\"timeline\") ?? \"\",\n    costRange: fieldMap.get(\"costRange\") ?? \"\",\n    decision: (fieldMap.get(\"decision\") ?? \"accepted\") as CaseAssessment[\"decision\"],\n  };\n}\n\nconst LawyerAssessmentScreen = forwardRef<HTMLDivElement, LawyerAssessmentScreenProps>(\n  ({ className, script, onAssessmentComplete }, ref) => {\n    const [fields, setFields] = useState<AssessmentField[]>([]);\n    const [activeFieldKey, setActiveFieldKey] = useState<string | undefined>();\n    const [mascotMotion, setMascotMotion] = useState<MascotMotionType>(MascotMotion.THINKING);\n    const scriptIndexRef = useRef(0);\n    const allFieldsComplete = scriptIndexRef.current >= script.length && fields.length > 0;\n\n    const handleAdvance = useCallback(() => {\n      if (scriptIndexRef.current >= script.length) return;\n\n      const step = script[scriptIndexRef.current];\n\n      if (step.mascotMotion) {\n        setMascotMotion(step.mascotMotion);\n      }\n\n      // Add the field with its value filled in\n      setFields((prev) => {\n        const exists = prev.some((f) => f.key === step.fieldKey);\n        if (exists) {\n          return prev.map((f) =>\n            f.key === step.fieldKey ? { ...f, value: step.value, isComplete: true } : f\n          );\n        }\n        return [\n          ...prev,\n          {\n            key: step.fieldKey,\n            label: step.fieldKey,\n            value: step.value,\n            isComplete: true,\n          },\n        ];\n      });\n\n      scriptIndexRef.current += 1;\n\n      // Set next field as active, or clear if done\n      if (scriptIndexRef.current < script.length) {\n        setActiveFieldKey(script[scriptIndexRef.current].fieldKey);\n      } else {\n        setActiveFieldKey(undefined);\n      }\n    }, [script]);\n\n    const handleComplete = useCallback(() => {\n      const assessment = buildAssessment(fields);\n      onAssessmentComplete?.(assessment);\n    }, [fields, onAssessmentComplete]);\n\n    return (\n      <div\n        className={cn(\n          \"relative flex min-h-screen flex-col items-center bg-gradient-to-br from-indigo-50 via-purple-50/30 to-white px-4 py-8\",\n          className\n        )}\n        ref={ref}\n      >\n        <div className=\"pointer-events-none absolute top-[-10%] right-[-10%] h-[500px] w-[500px] animate-pulse rounded-full bg-indigo-200/30 blur-3xl\" />\n\n        <div className=\"relative z-10 w-full max-w-2xl\">\n          <div className=\"mb-6 flex justify-center\">\n            <StepIndicator currentStep={3} steps={STEPS} />\n          </div>\n\n          <div className=\"mb-6 flex justify-center\">\n            <LegaliMascot height={80} motion={mascotMotion} width={80} />\n          </div>\n\n          <AssessmentWritingForm activeFieldKey={activeFieldKey} fields={fields} />\n\n          {/* Click-to-advance controls */}\n          <div className=\"mt-4 flex justify-center\">\n            {allFieldsComplete ? (\n              <Button className=\"rounded-xl\" onClick={handleComplete} size=\"sm\">\n                Submit Assessment\n                <ChevronRight className=\"ml-1 h-4 w-4\" />\n              </Button>\n            ) : (\n              <Button className=\"rounded-xl\" onClick={handleAdvance} size=\"sm\" variant=\"outline\">\n                <FileEdit className=\"mr-1 h-4 w-4\" />\n                {fields.length === 0 ? \"Start Writing\" : \"Write Next Field\"}\n              </Button>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n);\n\nLawyerAssessmentScreen.displayName = \"LawyerAssessmentScreen\";\n\nexport { LawyerAssessmentScreen };\n",
      "type": "registry:ui"
    }
  ],
  "dependencies": [
    "lucide-react"
  ],
  "registryDependencies": [
    "https://raw.githubusercontent.com/rryando/legali-ai-components/main/registry/legali-lib-utils.json",
    "https://raw.githubusercontent.com/rryando/legali-ai-components/main/registry/legali-step-indicator.json",
    "https://raw.githubusercontent.com/rryando/legali-ai-components/main/registry/legali-assessment-writing-form.json",
    "https://raw.githubusercontent.com/rryando/legali-ai-components/main/registry/legali-button.json",
    "https://raw.githubusercontent.com/rryando/legali-ai-components/main/registry/legali-mascot.json",
    "https://raw.githubusercontent.com/rryando/legali-ai-components/main/registry/legali-marketplace-types.json"
  ]
}