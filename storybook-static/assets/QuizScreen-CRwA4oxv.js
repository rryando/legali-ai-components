import{j as r}from"./jsx-runtime-BjG_zV1W.js";import{r as e}from"./index-yIsmwZOr.js";import{c as G}from"./utils-CDN07tui.js";import{Q as me}from"./QuizHeader-D4vIS8m-.js";import{Q as de}from"./QuizQuestion-DH3ApVU5.js";import{Q as pe}from"./QuizFeedback-CMksgjil.js";import{T as fe}from"./TypingText-a-MuFZ1k.js";import{a as l,L as he}from"./LegaliMascot-YN_T4VAf.js";import{A as be}from"./Answer-Cm3wYL8a.js";import{B as we}from"./button-CXZ-4DRD.js";const Z=[{motion:l.SPEAKING,durationMs:3500,lines:["Quick tip:","Read for what the court needs: amount, venue, and timing."]},{motion:l.THINKING,durationMs:null,lines:["Pick the best answer.","If unsure, eliminate obvious mismatches."]}],H=e.forwardRef(({className:W,active:c=!0,script:M,interruptScript:v,triggerKey:T,inactiveMotion:k=l.IDLE,mascotWidth:S=140,mascotHeight:U=140,mascotBlink:d=!0,stream:i,onStepChange:A,onMotionChange:E,...N})=>{const P=e.useRef([]),I=e.useCallback(()=>{P.current.forEach(o=>clearTimeout(o)),P.current=[]},[]),[K,u]=e.useState(0),[B,w]=e.useState(k),y=e.useCallback((o,h)=>{u(o),w(h),A==null||A(o),E==null||E(h)},[E,A]),j=e.useCallback(o=>{if(I(),!o.length){y(0,k);return}y(0,o[0].motion);let h=0;for(let m=0;m<o.length-1;m++){const g=o[m].durationMs;if(g==null)break;h+=g;const D=o[m+1],L=window.setTimeout(()=>{y(m+1,D.motion)},h);P.current.push(L)}},[I,k,y]),f=e.useMemo(()=>M!=null&&M.length?M:Z,[M]),a=e.useMemo(()=>v!=null&&v.length?v:void 0,[v]),q=e.useRef(T);e.useEffect(()=>{if(!c){I(),w(k);return}const o=q.current!==T;return q.current=T,j(o&&a?a:f),()=>{I()}},[c,T,f,a,k,j,I]);const p=f[K]??f[0]??Z[0],z=e.useMemo(()=>typeof window>"u"||typeof window.matchMedia!="function"?!1:window.matchMedia("(prefers-reduced-motion: reduce)").matches,[]),t=e.useMemo(()=>({charIntervalMs:(i==null?void 0:i.charIntervalMs)??28,linePauseMs:(i==null?void 0:i.linePauseMs)??5e3,loop:(i==null?void 0:i.loop)??!0,showCursor:(i==null?void 0:i.showCursor)??!1,fitToStepDuration:(i==null?void 0:i.fitToStepDuration)??!0}),[i]),C=e.useMemo(()=>((p==null?void 0:p.lines)??[]).map(o=>o==null?void 0:o.trim()).filter(Boolean),[p==null?void 0:p.lines]),F=e.useCallback(()=>{const m=b=>Math.max(56,Math.min(120,b));if(!t.fitToStepDuration||p.durationMs==null)return m(t.charIntervalMs);const g=C.reduce((b,x)=>b+x.length,0);if(g<=0)return m(t.charIntervalMs);const D=Math.max(0,C.length-1)*t.linePauseMs,R=Math.max(0,p.durationMs-D)/g;return m(R)},[p.durationMs,C,t.charIntervalMs,t.fitToStepDuration,t.linePauseMs]);return r.jsx("div",{className:G("w-full max-w-md mx-auto",W),...N,children:r.jsxs("div",{className:"p-2  flex items-center gap-2",children:[r.jsxs("div",{className:"shrink-0 relative",children:[r.jsx("div",{className:"absolute inset-0 -z-10 flex items-center justify-center pointer-events-none",children:r.jsx("div",{className:"absolute w-44 h-44 rounded-full bg-white/55 blur-3xl"})}),r.jsx(he,{motion:B,isBlink:d,width:S,height:U,className:"mx-auto"})]}),r.jsx("div",{className:"flex-1",children:r.jsx("div",{className:G("rounded-2xl border border-white/60 bg-white/70 backdrop-blur-md px-2 py-3"),children:r.jsx("div",{className:"text-sm md:text-base text-slate-700 leading-relaxed",children:z?c?r.jsx("p",{className:"font-semibold",children:C[0]??""}):null:c?r.jsx(fe,{className:"font-semibold",texts:C,speed:F(),delay:500,showCursor:t.showCursor,cursor:"▍",cursorClassName:"text-slate-500",loop:t.loop,pauseDuration:t.linePauseMs,startOnView:!1,once:!1},`${K}:${String(T??"")}`):null})})})]})})});H.displayName="QuizMascotPrompt";H.__docgenInfo={description:"",methods:[],displayName:"QuizMascotPrompt",props:{active:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},script:{required:!0,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  motion: MascotMotionType
  /** Duration for this step in milliseconds. Use \`null\` for infinite duration (no auto-advance). */
  durationMs: number | null
  /** Text snippets that will loop continuously while the step is active. */
  lines: string[]
}`,signature:{properties:[{key:"motion",value:{name:"unknown[union]",raw:"(typeof MascotMotion)[keyof typeof MascotMotion]",required:!0}},{key:"durationMs",value:{name:"union",raw:"number | null",elements:[{name:"number"},{name:"null"}],required:!0},description:"Duration for this step in milliseconds. Use `null` for infinite duration (no auto-advance)."},{key:"lines",value:{name:"Array",elements:[{name:"string"}],raw:"string[]",required:!0},description:"Text snippets that will loop continuously while the step is active."}]}}],raw:"QuizMascotScriptStep[]"},description:"Primary script that runs when activated."},interruptScript:{required:!1,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:`{
  motion: MascotMotionType
  /** Duration for this step in milliseconds. Use \`null\` for infinite duration (no auto-advance). */
  durationMs: number | null
  /** Text snippets that will loop continuously while the step is active. */
  lines: string[]
}`,signature:{properties:[{key:"motion",value:{name:"unknown[union]",raw:"(typeof MascotMotion)[keyof typeof MascotMotion]",required:!0}},{key:"durationMs",value:{name:"union",raw:"number | null",elements:[{name:"number"},{name:"null"}],required:!0},description:"Duration for this step in milliseconds. Use `null` for infinite duration (no auto-advance)."},{key:"lines",value:{name:"Array",elements:[{name:"string"}],raw:"string[]",required:!0},description:"Text snippets that will loop continuously while the step is active."}]}}],raw:"QuizMascotScriptStep[]"},description:"Script that runs when `triggerKey` changes (interrupt + restart)."},triggerKey:{required:!1,tsType:{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}]},description:"Change this value to immediately restart the script."},inactiveMotion:{required:!1,tsType:{name:"unknown[union]",raw:"(typeof MascotMotion)[keyof typeof MascotMotion]"},description:"",defaultValue:{value:"'IDLE'",computed:!1}},mascotWidth:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"",defaultValue:{value:"140",computed:!1}},mascotHeight:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"",defaultValue:{value:"140",computed:!1}},mascotBlink:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},stream:{required:!1,tsType:{name:"signature",type:"object",raw:`{
  /** Base typing speed (ms per character) when \`fitToStepDuration\` is false or step is infinite. */
  charIntervalMs?: number
  /** Pause between lines (ms). */
  linePauseMs?: number
  /** Whether to loop through lines continuously while the step is active. */
  loop?: boolean
  /** Whether to show a blinking cursor while typing. */
  showCursor?: boolean
  /** When step has a finite duration, scale typing speed to fit within it. */
  fitToStepDuration?: boolean
}`,signature:{properties:[{key:"charIntervalMs",value:{name:"number",required:!1},description:"Base typing speed (ms per character) when `fitToStepDuration` is false or step is infinite."},{key:"linePauseMs",value:{name:"number",required:!1},description:"Pause between lines (ms)."},{key:"loop",value:{name:"boolean",required:!1},description:"Whether to loop through lines continuously while the step is active."},{key:"showCursor",value:{name:"boolean",required:!1},description:"Whether to show a blinking cursor while typing."},{key:"fitToStepDuration",value:{name:"boolean",required:!1},description:"When step has a finite duration, scale typing speed to fit within it."}]}},description:""},onStepChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(index: number) => void",signature:{arguments:[{type:{name:"number"},name:"index"}],return:{name:"void"}}},description:""},onMotionChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(motion: MascotMotionType) => void",signature:{arguments:[{type:{name:"unknown[union]",raw:"(typeof MascotMotion)[keyof typeof MascotMotion]"},name:"motion"}],return:{name:"void"}}},description:""}}};const ee=e.forwardRef(({className:W,questions:c,onClose:M,onQuizComplete:v,...T},k)=>{var V,_,$,O,Y,J,X;const[S,U]=e.useState(0),[d,i]=e.useState(null),[A,E]=e.useState({}),[N,P]=e.useState(!1),[I,K]=e.useState(0),[u,B]=e.useState(!1),[w,y]=e.useState(!1),[j,f]=e.useState(!1),[a,q]=e.useState(null),[p,z]=e.useState(!1),t=c==null?void 0:c[S];if(!t)return r.jsx("div",{className:"p-8 text-center text-slate-500",children:"No questions available."});const C=S===c.length-1,F=S/c.length*100;e.useEffect(()=>{y(!1),f(!1),q(null),z(!1)},[t.id]),e.useEffect(()=>{if(u){f(!1);return}if(!w){f(!1);return}const n=window.setTimeout(()=>{f(!0)},8e3);return()=>window.clearTimeout(n)},[w,u,t.id]);const o=e.useMemo(()=>[{motion:l.SPEAKING,durationMs:2800,lines:["Quick tip:","Look for jurisdiction, money limits, and timing."]},{motion:l.THINKING,durationMs:null,lines:["Eliminate obvious mismatches.","Then choose the best fit."]}],[]),h=e.useMemo(()=>[{motion:l.SPEAKING,durationMs:2600,lines:["Let’s read this carefully.","Focus on the key detail."]},{motion:l.SPEAKING,durationMs:null,lines:["Take your time.","Then choose the best answer."]}],[]),m=e.useMemo(()=>[{motion:l.CELEBRATE,durationMs:2200,lines:["Nice!","That’s the right idea."]},{motion:l.SPEAKING,durationMs:2600,lines:["Keep going — one question at a time."]}],[]),g=e.useMemo(()=>[{motion:l.CONFUSED,durationMs:2400,lines:["Close — but not quite.","Let’s use the explanation to lock it in."]},{motion:l.SPEAKING,durationMs:2600,lines:["You’ll spot this pattern next time."]}],[]),D=e.useMemo(()=>{var n,s;return(s=(n=t.mascot)==null?void 0:n.script)!=null&&s.length?t.mascot.script:o},[(V=t.mascot)==null?void 0:V.script,o]),L=e.useMemo(()=>{var n,s;return(s=(n=t.mascot)==null?void 0:n.onReading)!=null&&s.length?t.mascot.onReading:h},[(_=t.mascot)==null?void 0:_.onReading,h]),R=e.useMemo(()=>{var n,s;return(s=(n=t.mascot)==null?void 0:n.onRevealCorrect)!=null&&s.length?t.mascot.onRevealCorrect:m},[($=t.mascot)==null?void 0:$.onRevealCorrect,m]),b=e.useMemo(()=>{var n,s;return(s=(n=t.mascot)==null?void 0:n.onRevealIncorrect)!=null&&s.length?t.mascot.onRevealIncorrect:g},[(O=t.mascot)==null?void 0:O.onRevealIncorrect,g]),x=u&&a!=null&&w&&!p;e.useEffect(()=>{if(!x)return;const s=(a?R:b).reduce((le,ce)=>le+(ce.durationMs??0),0),Q=window.setTimeout(()=>{z(!0)},Math.max(1200,s));return()=>window.clearTimeout(Q)},[x,a,R,b]);const te=n=>{N||i(n)},ne=()=>{var s;if(!d)return;const n=!!((s=t.answers.find(Q=>Q.id===d))!=null&&s.correct);n&&K(Q=>Q+1),E(Q=>({...Q,[t.id]:d})),P(!0),B(!0),q(n)},se=()=>{var n;C?v(I+((n=t.answers.find(s=>s.id===d))!=null&&n.correct&&!N?1:0),c.length,A):(U(s=>s+1),i(null),P(!1),B(!1),y(!1),q(null),z(!1))},re=e.useMemo(()=>u&&a!=null?!0:!u,[a,u]),oe=e.useMemo(()=>{const n=a==null?"none":a?"correct":"incorrect",s=u?"feedback":j?"hint":"reading";return`${String(t.id)}:${s}:${n}`},[t.id,a,j,u]),ie=e.useMemo(()=>x||u&&a!=null?a?R:b:j?D:L,[R,D,b,a,j,L,x,u]),ae=e.useMemo(()=>{var s;return{...((s=t.mascot)==null?void 0:s.stream)??{},loop:!x}},[(Y=t.mascot)==null?void 0:Y.stream,x]),ue=e.useMemo(()=>u?a===!0?l.CELEBRATE:l.IDLE:w?l.IDLE:l.WRITING,[a,w,u]);return r.jsxs("div",{ref:k,className:G("flex flex-col h-full min-h-screen relative overflow-hidden","bg-gradient-to-br from-sky-100 via-blue-50 to-white",W),...T,children:[r.jsx("div",{className:"absolute top-[-10%] right-[-10%] w-[600px] h-[600px] bg-sky-200/40 rounded-full blur-3xl pointer-events-none animate-pulse"}),r.jsx("div",{className:"absolute bottom-[-10%] left-[-10%] w-[500px] h-[500px] bg-blue-200/40 rounded-full blur-3xl pointer-events-none animate-pulse delay-700"}),r.jsx(me,{onClose:M,currentQuestion:S+1,totalQuestions:c.length,progress:F,className:"bg-white/40 backdrop-blur-md border-white/20 sticky top-0 z-10"}),r.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-8 pb-32 relative z-0",children:r.jsxs("div",{className:"max-w-2xl mx-auto",children:[r.jsx(de,{question:t.question,questionNumber:S+1,typingKey:t.id,typingSpeedMs:70,showCursor:((J=t.typing)==null?void 0:J.showCursor)??!1,onTypedComplete:()=>y(!0),className:"mb-8"}),r.jsx(H,{className:"mb-6",active:re,triggerKey:oe,script:ie,stream:ae,inactiveMotion:ue,mascotWidth:240,mascotHeight:240}),r.jsx("div",{className:"space-y-3 animate-slide-in-from-bottom",children:t.answers.map((n,s)=>r.jsx(be,{selected:d===n.id,correct:N&&n.correct,incorrect:N&&d===n.id&&!n.correct,onClick:()=>te(n.id),disabled:N,shortcut:String.fromCharCode(65+s),className:"animate-fade-in bg-white/60 backdrop-blur-sm border-white/40 hover:bg-white/80",children:n.text},n.id))})]})}),!u&&r.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-5 bg-white/30 backdrop-blur-xl border-t border-white/20 z-10",children:r.jsx("div",{className:"max-w-2xl mx-auto",children:r.jsx(we,{onClick:ne,disabled:!d,className:G("w-full font-bold py-6 text-lg rounded-2xl shadow-xl transition-all duration-300",d?"bg-blue-600 hover:bg-blue-700 text-white shadow-blue-500/30 hover:-translate-y-1 hover:shadow-2xl":"bg-slate-200 text-slate-400 cursor-not-allowed"),children:"Check Answer"})})}),r.jsx(pe,{show:u,correct:((X=t.answers.find(n=>n.id===d))==null?void 0:X.correct)||!1,explanation:t.explanation,onContinue:se,className:"backdrop-blur-xl bg-white/80 border-t border-white/40"})]})});ee.displayName="QuizScreen";ee.__docgenInfo={description:"",methods:[],displayName:"QuizScreen",props:{questions:{required:!0,tsType:{name:"Array",elements:[{name:"Question"}],raw:"Question[]"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onQuizComplete:{required:!0,tsType:{name:"signature",type:"function",raw:"(score: number, total: number, userAnswers: Record<string | number, string | number>) => void",signature:{arguments:[{type:{name:"number"},name:"score"},{type:{name:"number"},name:"total"},{type:{name:"Record",elements:[{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}]},{name:"union",raw:"string | number",elements:[{name:"string"},{name:"number"}]}],raw:"Record<string | number, string | number>"},name:"userAnswers"}],return:{name:"void"}}},description:""}}};export{ee as Q};
